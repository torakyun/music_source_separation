# 生成的最適化に基づく音楽音源分離の検証

## 音楽音源分離の概要と現状
音楽音源分離は，一度合成された楽曲を，個々の楽音に分解する技術のことを指す．
楽音の個別操作が可能になることで，
音楽配信サービス上で高度な機能を実現することにつながる．
実際に，音楽音源分離は，リミックスやカラオケ音源の作成，
音楽情報検索，音楽教育といった機能への応用が試みられてきた．
しかし，現在の技術では，他の音源からの分離漏れや，
対象の音源自体の欠損といった問題を完全に消すことはできていない．
また，音声の一部に雑音が生じてしまうことがあり，
これらの要素が 人間の知覚評価を下げる要因になる．

<img width="800" src="https://user-images.githubusercontent.com/67317828/217169110-5bfc0204-bf78-4a7c-9a9f-8bb44e5d6c31.gif">
  
## 従来の最適化と生成分野の最適化
音楽音源分離は，過去10年間に集中的に研究されており，深層学習の登場によって飛躍的な進歩を遂げた．
深層学習による音楽音源分離では，
生成的な構造を取り入れたモデルが提案されている一方で，
このようなモデルの最適化は生成分野のものとは異なる．
従来の最適化では，時間領域上で波形損失の最小化が行われてきた．
波形損失は，時間波形の各時刻において教師との差分を取ることで求められる．
つまり，同時刻における単一の信号が比較される．
それに対して，生成分野の最適化では，系列信号の時間変化を考慮する．
STFT損失の最小化を行うと，音声の周波数特性を学習することができる．
人間の聴覚系も周波数分析を行っており，人間の知覚に基づいた方法といえる．
また，敵対的損失の最小化を行うと，音声の本物らしさを学習することができる．
敵対的損失の最小化は，出力系列が本物の音声である確率の最大化に基づいており，
本物らしい生成を可能にする．

<img width="800" alt="architecture3" src="https://user-images.githubusercontent.com/67317828/217165468-09999921-727f-4427-999d-d29c7e9862b8.png">

## 生成的最適化に基づく音楽音源分離
そこで本研究では，生成的最適化に基づく音楽音源分離を実装し，
従来の最適化と比較してその有効性を検証する．
検証の結果，STFT損失の最小化は，
人間の知覚に基づく分離精度の評価を向上させることが確認できた．
一方で，敵対的損失の最小化を取り入れると，分離精度を低下させる結果となった．
敵対的損失を計算する識別器が，分離音声を生成する生成器に比べて，
訓練データに過剰に適合してしまったことが原因であると思われる．
対策としては，識別器の軽量化や，過学習を抑える技術の導入などが考えられる．
敵対的損失を学習する際の不安定さを解消し，
分離精度および音質汚染をさらに改善していくことが今後の課題である．

<img width="800" alt="mos" src="https://user-images.githubusercontent.com/67317828/217165737-f65893ec-c37f-4c64-b1df-6c7952dbdba2.png">
<img width="800" alt="sdr" src="https://user-images.githubusercontent.com/67317828/217165754-8ab9c279-5d66-47b0-bac3-e2868312cdea.png">
